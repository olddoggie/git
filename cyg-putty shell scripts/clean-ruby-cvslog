#!/usr/bin/bash
if [[ $2 = "dos" ]]; then
echo "This script is used for eliminate the duplicated lines for file list when a file is released on branch, but not changed after branch created, by default, cvs will return all the history comments."
echo ""
echo "Rational is using sed to change txt lines in file, which is generated by ruby script."
echo ""
echo "first param is the input file name."
echo ""
echo "second param is the input file's format, if dos, then script will finnaly transfer file back to dos format; if not specified,then no unix2dox step at last."
echo ""
echo "!!After script,double check: if any ruby file list is still dos format.... if not, run clean-ruby-cvslog dos "
echo ""
fi
file="$1"
format="$2"
temporary=temporary-"$file"

cat "$file" | grep "\----------------------------" > "$temporary"

if [[ -s "$temporary" ]]
 then
	cat "$file" | sed 's#----------------------------.*$#"#g' > "$file"
	if [[ $format = "dos" ]]; then
		unix2dos -k "$file"
	fi
echo "Ok."
fi
rm -f "$temporary"